#!/usr/bin/env ruby

$LOAD_PATH << File.join(File.dirname(__FILE__), 'lib')

require "menu"
require "server"

begin
  Dir.chdir(Server::SERVER_DIR)
  Server.initialize
  Menu.initialize
  Signal.trap "HUP" do
    FileUtils.rm "pid/" + Games.game.ttyrec
    system "gzip", "-q", "inprogress/" + Games.game.ttyrec
    FileUtils.mv "inprogress/" + Games.game.ttyrec + ".gz", "ttyrec/"
    exit
  end
  Menu.mainmenu
ensure
  Menu.destroy
end

